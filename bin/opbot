#!/usr/bin/env python3
# This file is placed in the Public Domain.

from op.run import Console, cfg, exec, parse_cli, os

cfg.wd = os.path.expanduser("~/.opbot")

class Console(Console):

    def direct(self, txt):
        print(txt)

def main():
    parse_cli()
    h = Console()
    h.fromdir(os.path.join(cfg.wd, "mod"))
    h.load_mod("cli,cmd,irc,usr,ver")
    h.load_mod(cfg.mods)
    if cfg.txt:
        return h.cmd(cfg.otxt)
    if cfg.op("c"):
        h.start()
        h.init(cfg.mods)
        h.wait()

exec(main)

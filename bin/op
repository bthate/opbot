#!/usr/bin/env python3
# This file is placed in the Public Domain.

import os, readline, shutil

from op.hdl import BusCore
from op.run import cfg, parse_cli
from op.trm import exec

name = "opbot"
wd = "/var/lib/%s/" % name
md = os.path.join(cfg.wd, "mod")

class Basic(BusCore):

    def direct(self, txt):
        print(txt)

def main():
    parse_cli()
    if not cfg.op("r"):
        cfg.wd = wd = os.path.expanduser("~/.opbot")
        cfg.md = md = os.path.join(cfg.wd, "mod")
    h = Basic()
    h.fromdir(cfg.md)
    h.walk("opbot,opm,mod")
    h.walk(cfg.mods)
    return h.cmd(cfg.otxt)

exec(main)
